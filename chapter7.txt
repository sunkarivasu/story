this is chater7 in branch3